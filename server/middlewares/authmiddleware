const user = require('../models/user')

const authMiddleware = async (req, res, next) => {
  try {
		const userEmail = req.session.userid;
		console.log(userEmail);
		const authUser = await user.findOne({ email: userEmail });
		console.log(authUser);
		if (!authUser) {
			console.error("login credentials not found");
			res.status(401);
			res.send("login credentials not found");
		}
		req.authUser = authUser;
		res.status(200);
		next();
	} catch (error) {
		console.error('Authentication failed');
		res.status(401);
		res.send('Authentication failed');
	}
};

module.exports = authMiddleware;